
	<!--Handlebars.js template for modules-->
	<script id="moduleTemplate" type="text/x-handlebars-template">
		<div class="module {{moduleCssClass}}">
			<span class="dataContainer"></span>

			<header>
				<div style="margin: 0 0 5px 0;">{{moduleName}}</div>
			</header>

			{{#if hasKeyboardInterface}}
			<div id="keyboard"></div>
			{{/if}}

			{{#if hasStartButton}}
			<fieldset>
				<button>Start</button>
			</fieldset>
			{{/if}}

			{{#each sections}}

			<fieldset {{#if ../renderSectionsVertically}}class="verticalAligned"{{/if}}>

				{{#if sectionName}}
					<legend>{{sectionName}}</legend>
				{{/if}}

				{{#each buttons}}
				<button name="{{buttonId}}">{{buttonName}}</button>
				{{/each}}
				
				{{#each checkBoxes}}
				<div>
					<span title="{{type}}" class="parameterLabel ">{{label}}: </span> <input type="checkbox" data-parametertype="{{type}}" />
				</div>
				{{/each}}

				{{#each radioButtonLists}}
				<div>
					<span title="{{type}}" class="parameterLabel ">{{label}}: </span>
					{{#each radioButtons}}
						<input 	type="radio" 
								name="{{../rdoName}}" 
								value="{{value}}" 
								title="{{value}}" 
								data-parametertype="{{../type}}" 
								{{#if selected}}checked{{/if}}>
									{{{name}}}					{{!--Note triple stash for rendering html entities on label--}}
								</input>
					{{/each}}
				</div>
				{{/each}}

				{{#each selectLists}}
				<div>
					<span title="{{type}}" class="parameterLabel ">{{label}}: </span>
					<select data-parametertype="{{type}}">
					{{#each options}}
						<option value="{{value}}" 
							{{#if selected}}selected{{/if}} >
							{{name}}
						</option>
					{{/each}}
					</select>
				</div>
				{{/each}}

				{{#each ranges}}
				<div class="{{../rangeDisplayMode}}">
					<span title="{{type}}" class="parameterLabel {{../rangeDisplayMode}}">{{label}} </span>
					<input 	type="range" 
							data-parametertype="{{type}}" 
							min="{{min}}" 
							max="{{max}}" 
							value="{{value}}" 
							step="{{step}}" 
							name="{{name}}"
							title="{{value}}"

							{{#ifCond ../rangeDisplayMode "knob"}}
								data-width="50"
								data-height="50"
								data-angleOffset="220"
								data-angleRange="280"
							{{/ifCond}}

							class="{{../rangeDisplayMode}}"							 />

					<output for="{{name}}" class="{{../rangeDisplayMode}}">{{value}}</output>
					
				</div>
				{{/each}}

			</fieldset>

			{{/each}}

			{{#if hiddenParameters}}
			<fieldset>
			{{#each hiddenParameters}}
			<div>
				<input	type="hidden"
						data-parametertype="{{type}}"
						name="{{name}}"
						value="{{value}}" />
			</div>
			{{/each}}
			</fieldset>
			{{/if}}

			<fieldset class="connectors">
				<legend>Connectors</legend>
				{{#if hasTriggerIn}}
					<div><div>Trigger<br/>In</div><div><span class="patchHole " data-patch-type="triggerIn">&nbsp;</span></div></div>
				{{/if}}

				{{#if hasTriggerOut}}
					<div><div>Trigger<br/>Out</div><div><span class="patchHole " data-patch-type="triggerOut">&nbsp;</span></div></div>
				{{/if}}

				{{#if hasControlIn}}
					<div><div>Control<br/>In</div><div><span class="patchHole " data-patch-type="controlIn">&nbsp;</span></div></div>
				{{/if}}

				{{#if hasControlOut}}
					<div><div>Control<br/>Out</div><div><span class="patchHole " data-patch-type="controlOut">&nbsp;</span></div></div>
				{{/if}}

				{{#if hasAudioIn}}
					<div><div>Audio<br/>In</div><div><span class="patchHole " data-patch-type="audioIn">&nbsp;</span></div></div>
				{{/if}}

				{{#if hasAudioOut}}
					<div><div>Audio<br/>Out</div><div><span class="patchHole " data-patch-type="audioOut">&nbsp;</span></div></div>
				{{/if}}
			</fieldset>
		</div>
	</script>

<script>
	// importDoc references this import's document
	var importDoc = document.currentScript.ownerDocument;

	// mainDoc references the main document (the page that's importing us)
	var mainDoc = document;

	// Grab the element from this import, clone it,
	// and append it to the importing document.
	var el = importDoc.querySelector('#moduleTemplate');
	mainDoc.body.appendChild(el.cloneNode(true));
</script>
